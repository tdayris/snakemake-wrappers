.. _`bio/msisensor_pro/msi`:

MSISENSOR PRO MSI
=================

Search for micro satellites in tumor vs normal

**URL**: https://github.com/xjtu-omics/msisensor-pro/wiki/Key-Commands#msi-from-msisensor

Example
-------

This wrapper can be used in the following way:

.. code-block:: python

    rule test_msisensor_msi:
        input:
            normal = "example.normal.bam",
            tumor = "example.tumor.bam",
            microsat = "example.microsate.sites"
        output:
            "example.msi",
            "example.msi_dis",
            "example.msi_germline",
            "example.msi_somatic"
        threads:
            1
        log:
            "example.log"
        wrapper:
            "0.50.4-2418-g8fefa1e53/bio/msisensor_pro/msi"

Note that input, output and log file paths can be chosen freely.

When running with

.. code-block:: bash

    snakemake --use-conda

the software dependencies will be automatically deployed into an isolated environment before execution.

Software dependencies
---------------------

* ``msisensor-pro==1.2.0``

Input/Output
------------
**Input:**

* ``microsat``: Path to homopolymer files
* ``normal``: Path to normal bam
* ``tumor``: Path to tumor bam

**Output:**

* Path to MSI results




Notes
-----

This tools directly comes from msisensor.



Authors
-------

* Thibault Dayris


Code
----

.. code-block:: python

    #!/usr/bin/env python3
    # -*- coding: utf-8 -*-

    """Snakemake script for MSISensor msi"""

    __author__ = "Thibault Dayris"
    __copyright__ = "Copyright 2021, Dayris Thibault"
    __email__ = "thibault.dayris@gustaveroussy.fr"
    __license__ = "MIT"

    from os.path import commonprefix
    from snakemake.shell import shell

    log = snakemake.log_fmt_shell(stdout=True, stderr=True)

    # Extra parameters default value is an empty string
    extra = snakemake.params.get("extra", "")

    # Detemining common prefix in output files
    # to fill the requested parameter '-o'
    prefix = commonprefix(snakemake.output)

    region = ""
    if "bed" in snakemake.input.keys():
        region = f"-e {snakemake.input.bed}"

    shell(
        "msisensor-pro msi"  # Tool and its sub-command
        " -d {snakemake.input.microsat}"  # Path to homopolymer/microsat file
        " -n {snakemake.input.normal}"  # Path to normal bam
        " -t {snakemake.input.tumor}"  # Path to tumor bam
        " -o {prefix}"  # Path to output distribution file
        " -b {snakemake.threads}"  # Maximum number of threads used
        " {region}"
        " {extra}"  # Optional extra parameters
        " {log}"  # Logging behavior
    )


.. |nl| raw:: html

   <br>