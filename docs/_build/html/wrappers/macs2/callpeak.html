<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MACS2 CALLPEAK &mdash; Snakemake Wrappers heads/Unofficial documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="MAFTOOLS" href="../maftools.html" />
    <link rel="prev" title="MACS2" href="../macs2.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Snakemake Wrappers
          </a>
              <div class="version">
                heads/Unofficial
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Wrappers, Meta-Wrappers</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../wrappers.html">Wrappers</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../BiGR.html">BIGR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Rsamtools.html">RSAMTOOLS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SomaticSignatures.html">SOMATICSIGNATURES</a></li>
<li class="toctree-l2"><a class="reference internal" href="../VariantAnnotation.html">VARIANTANNOTATION</a></li>
<li class="toctree-l2"><a class="reference internal" href="../adapterremoval.html">ADAPTERREMOVAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../arriba.html">ARRIBA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../art.html">ART</a></li>
<li class="toctree-l2"><a class="reference internal" href="../assembly-stats.html">ASSEMBLY-STATS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../awk.html">AWK</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bamtools.html">BAMTOOLS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bbtools.html">BBTOOLS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bcftools.html">BCFTOOLS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bcl2fastq.html">BCF2FASTQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bedtools.html">BEDTOOLS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../benchmark.html">BENCHMARK</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bgzip.html">BGZIP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../biobambam2.html">BIOBAMBAM2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bioinfokit.html">BIOINFOKIT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../biomaRt.html">BIOMART</a></li>
<li class="toctree-l2"><a class="reference internal" href="../biseq.html">BISEQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bismark.html">BISMARK</a></li>
<li class="toctree-l2"><a class="reference internal" href="../blast.html">BLAST</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bowtie2.html">BOWTIE2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../busco.html">BUSCO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bwa.html">BWA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bwa-mem2.html">BWA-MEM2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cairosvg.html">CAIROSVG</a></li>
<li class="toctree-l2"><a class="reference internal" href="../check_md5.html">CHECK MD5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chipseeker.html">CHIPSEEKER</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clustalo.html">CLUSTALO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clusterProfiler.html">CLUSTERPROFILER</a></li>
<li class="toctree-l2"><a class="reference internal" href="../compress.html">COMPRESS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concatenate_fastq.html">CONCATENATE FASTQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../consensusclusterplus.html">CONSENSUSCLUSTERPLUS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cp.html">CP (BASH)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cpat.html">CPAT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cutadapt.html">CUTADAPT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dada2.html">DADA2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deeptools.html">DEEPTOOLS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deepvariant.html">DEEPVARIANT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../delly.html">DELLY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deseq2.html">DESEQ2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../diamond.html">DIAMOND</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dragmap.html">DRAGMAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../eacon.html">EACON</a></li>
<li class="toctree-l2"><a class="reference internal" href="../enhancedVolcano.html">ENHANCEDVOLCANO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ensembl.html">ENSEMBL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../epic.html">EPIC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../facets.html">FACETS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fastp.html">FASTP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fastq_screen.html">FASTQ_SCREEN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fastqc.html">FASTQC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fgbio.html">FGBIO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fgsea.html">FGSEA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filtlong.html">FILTLONG</a></li>
<li class="toctree-l2"><a class="reference internal" href="../freebayes.html">FREEBAYES</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gatk.html">GATK</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gatk3.html">GATK3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gdc-api.html">GDC-API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gdc-client.html">GDC-CLIENT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gencode.html">GENCODE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../genomepy.html">GENOMEPY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gridss.html">GRIDSS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gsva.html">GSVA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gtf.html">GTF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hap.py.html">HAP.PY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hisat2.html">HISAT2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hmmer.html">HMMER</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homer.html">HOMER</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iRODS.html">IRODS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../igv-reports.html">IGV-REPORTS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../immunedeconv.html">IMMUNEDECONV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../infernal.html">INFERNAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../isoformSwitchAnalyseR.html">ISOFORMSWITCHANALYSER</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jannovar.html">JANNOVAR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kallisto.html">KALLISTO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../last.html">LAST</a></li>
<li class="toctree-l2"><a class="reference internal" href="../liftoff.html">LIFTOFF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lofreq.html">LOFREQ</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../macs2.html">MACS2</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">MACS2 CALLPEAK</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example">Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#software-dependencies">Software dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="#input-output">Input/Output</a></li>
<li class="toctree-l4"><a class="reference internal" href="#params">Params</a></li>
<li class="toctree-l4"><a class="reference internal" href="#notes">Notes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#authors">Authors</a></li>
<li class="toctree-l4"><a class="reference internal" href="#code">Code</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../maftools.html">MAFTOOLS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manta.html">MANTA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mapdamage2.html">MAPDAMAGE2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mashmap.html">MASHMAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../md5sum.html">MD5SUM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../microphaser.html">MICROPHASER</a></li>
<li class="toctree-l2"><a class="reference internal" href="../minimap2.html">MINIMAP2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mixcr.html">MIXCR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mlst.html">MLST</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mosdepth.html">MOSDEPTH</a></li>
<li class="toctree-l2"><a class="reference internal" href="../msisensor.html">MSISENSOR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../msisensor_pro.html">MSISENSOR_PRO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../multiqc.html">MULTIQC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../muscle.html">MUSCLE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nanosim-h.html">NANOSIM-H</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nextflow.html">NEXTFLOW</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ngs-disambiguate.html">NGS-DISAMBIGUATE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../open-cravat.html">OPEN-CRAVAT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../optitype.html">OPTITYPE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../paladin.html">PALADIN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pandas.html">PANDAS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pandora.html">PANDORA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pbmm2.html">PBMM2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pcaExplorer.html">PCAEXPLORER</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pear.html">PEAR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pfam.html">PFAM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pheatmap.html">PHEATMAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../picard.html">PICARD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pindel.html">PINDEL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plass.html">PLASS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preseq.html">PRESEQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../primerclip.html">PRIMERCLIP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../prosolo.html">PROSOLO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ptrimmer.html">PTRIMMER</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pyfastaq.html">PYFASTAQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../qualimap.html">QUALIMAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rasusa.html">RASUSA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../razers3.html">RAZERS3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rbt.html">RBT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rebaler.html">REBALER</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference.html">REFERENCE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../refgenie.html">REFGENIE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rest.html">REST</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rsem.html">RSEM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rubic.html">RUBIC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../salmon.html">SALMON</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sambamba.html">SAMBAMBA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../samtools.html">SAMTOOLS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sansa.html">SANSA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../seaborn.html">SEABORN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sed.html">SED</a></li>
<li class="toctree-l2"><a class="reference internal" href="../seqtk.html">SEQTK</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shovill.html">SHOVILL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sickle.html">SICKLE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sigprofiler.html">SIGPROFILER</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simplifyenrichment.html">SIMPLIFYENRICHMENT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sleuth.html">SLEUTH</a></li>
<li class="toctree-l2"><a class="reference internal" href="../snp-mutator.html">SNP-MUTATOR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../snpeff.html">SNPEFF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../snpsift.html">SNPSIFT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sort.html">SORT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sourmash.html">SOURMASH</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spades.html">SPADES</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spliceai.html">SPLICE AI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sra-tools.html">SRA-TOOLS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../star.html">STAR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../strelka.html">STRELKA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../strling.html">STRLING</a></li>
<li class="toctree-l2"><a class="reference internal" href="../subread.html">SUBREAD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tabix.html">TABIX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tmb.html">TMB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transdecoder.html">TRANSDECODER</a></li>
<li class="toctree-l2"><a class="reference internal" href="../trim_galore.html">TRIM_GALORE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../trimmomatic.html">TRIMMOMATIC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../trinity.html">TRINITY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tximeta.html">TXIMETA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tximport.html">TXIMPORT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ucsc.html">UCSC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../umis.html">UMIS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unicycler.html">UNICYCLER</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vardict.html">VARDICT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../variant_distribution.html">VARIANT_DISTRIBUTION</a></li>
<li class="toctree-l2"><a class="reference internal" href="../variantoccurence.html">VARIANTOCCURENCE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../varscan.html">VARSCAN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vcftools.html">VCFTOOLS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vembrane.html">VEMBRANE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vep.html">VEP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../verifybamid.html">VERIFYBAMID</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vg.html">VG</a></li>
<li class="toctree-l2"><a class="reference internal" href="../wgsim.html">WGSIM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../wisecondorx.html">WISECONDORX</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../meta-wrappers.html">Meta-Wrappers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Pipelines</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../pipelines.html">BiGR Pipelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../readme/readme_long.html">Long help</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bigr_unofficial.html">BiGR Unofficial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../apidocs/api.html">Unofficial API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Snakemake Wrappers</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../wrappers.html">Wrappers</a> &raquo;</li>
          <li><a href="../macs2.html">MACS2</a> &raquo;</li>
      <li>MACS2 CALLPEAK</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/wrappers/macs2/callpeak.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="macs2-callpeak">
<span id="bio-macs2-callpeak"></span><h1>MACS2 CALLPEAK<a class="headerlink" href="#macs2-callpeak" title="Permalink to this headline"></a></h1>
<p><code class="docutils literal notranslate"><span class="pre">MACS2</span> <span class="pre">callpeak</span></code> model-based analysis tool for ChIP-sequencing that calls peaks from alignment results.</p>
<p><strong>URL</strong>: <a class="reference external" href="https://github.com/macs3-project/MACS/blob/master/README.md">https://github.com/macs3-project/MACS/blob/master/README.md</a></p>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline"></a></h2>
<p>This wrapper can be used in the following way:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rule</span> <span class="n">callpeak</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">treatment</span><span class="o">=</span><span class="s2">&quot;samples/a.bam&quot;</span><span class="p">,</span>   <span class="c1"># required: treatment sample(s)</span>
        <span class="n">control</span><span class="o">=</span><span class="s2">&quot;samples/b.bam&quot;</span>      <span class="c1"># optional: control sample(s)</span>
    <span class="n">output</span><span class="p">:</span>
        <span class="c1"># all output-files must share the same basename and only differ by it&#39;s extension</span>
        <span class="c1"># Usable extensions (and which tools they implicitly call) are listed here:</span>
        <span class="c1">#         https://snakemake-wrappers.readthedocs.io/en/stable/wrappers/macs2/callpeak.html.</span>
        <span class="n">multiext</span><span class="p">(</span><span class="s2">&quot;callpeak/basename&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;_peaks.xls&quot;</span><span class="p">,</span>   <span class="c1">### required</span>
                 <span class="c1">### optional output files</span>
                 <span class="s2">&quot;_peaks.narrowPeak&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;_summits.bed&quot;</span>
                 <span class="p">)</span>
    <span class="n">log</span><span class="p">:</span>
        <span class="s2">&quot;logs/macs2/callpeak.log&quot;</span>
    <span class="n">params</span><span class="p">:</span>
        <span class="s2">&quot;-f BAM -g hs --nomodel&quot;</span>
    <span class="n">wrapper</span><span class="p">:</span>
        <span class="s2">&quot;0.79.0-2111-gcaef468e5/bio/macs2/callpeak&quot;</span>

<span class="n">rule</span> <span class="n">callpeak_options</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">treatment</span><span class="o">=</span><span class="s2">&quot;samples/a.bam&quot;</span><span class="p">,</span>   <span class="c1"># required: treatment sample(s)</span>
        <span class="n">control</span><span class="o">=</span><span class="s2">&quot;samples/b.bam&quot;</span>      <span class="c1"># optional: control sample(s)</span>
    <span class="n">output</span><span class="p">:</span>
        <span class="c1"># all output-files must share the same basename and only differ by it&#39;s extension</span>
        <span class="c1"># Usable extensions (and which tools they implicitly call) are listed here:</span>
        <span class="c1">#         https://snakemake-wrappers.readthedocs.io/en/stable/wrappers/macs2/callpeak.html.</span>
        <span class="n">multiext</span><span class="p">(</span><span class="s2">&quot;callpeak_options/basename&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;_peaks.xls&quot;</span><span class="p">,</span>   <span class="c1">### required</span>
                 <span class="c1">### optional output files</span>
                 <span class="c1"># these output extensions internally set the --bdg or -B option:</span>
                 <span class="s2">&quot;_treat_pileup.bdg&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;_control_lambda.bdg&quot;</span><span class="p">,</span>
                 <span class="c1"># these output extensions internally set the --broad option:</span>
                 <span class="s2">&quot;_peaks.broadPeak&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;_peaks.gappedPeak&quot;</span>
                 <span class="p">)</span>
    <span class="n">log</span><span class="p">:</span>
        <span class="s2">&quot;logs/macs2/callpeak.log&quot;</span>
    <span class="n">params</span><span class="p">:</span>
        <span class="s2">&quot;-f BAM -g hs --broad-cutoff 0.1 --nomodel&quot;</span>
    <span class="n">wrapper</span><span class="p">:</span>
        <span class="s2">&quot;0.79.0-2111-gcaef468e5/bio/macs2/callpeak&quot;</span>
</pre></div>
</div>
<p>Note that input, output and log file paths can be chosen freely.</p>
<p>When running with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>snakemake --use-conda
</pre></div>
</div>
<p>the software dependencies will be automatically deployed into an isolated environment before execution.</p>
</section>
<section id="software-dependencies">
<h2>Software dependencies<a class="headerlink" href="#software-dependencies" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">macs2&gt;=2.2</span></code></p></li>
</ul>
</section>
<section id="input-output">
<h2>Input/Output<a class="headerlink" href="#input-output" title="Permalink to this headline"></a></h2>
<p><strong>Input:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">control</span></code>: Path to input peaks (Optional)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">treatment</span></code>: SAM, BAM, BED, ELAND, ELANDMULTI, ELANDEXPORT, BOWTIE, BAMPE or BEDPE files</p></li>
</ul>
<p><strong>Output:</strong></p>
<ul class="simple">
<li><p>tabular file in excel format (.xls) AND</p></li>
<li><p>different optional metrics in bedGraph or BED formats</p></li>
</ul>
</section>
<section id="params">
<h2>Params<a class="headerlink" href="#params" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Optional</span> <span class="pre">parameters.</span> <span class="pre">This</span> <span class="pre">must</span> <span class="pre">b</span> <span class="pre">the</span> <span class="pre">only</span> <span class="pre">element</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">param</span> <span class="pre">section</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">snakemake</span> <span class="pre">rule</span></code>:</p></li>
</ul>
</section>
<section id="notes">
<h2>Notes<a class="headerlink" href="#notes" title="Permalink to this headline"></a></h2>
<p>For usage information about <code class="docutils literal notranslate"><span class="pre">MACS2</span> <span class="pre">callpeak</span></code>, please see the <a class="reference external" href="https://github.com/macs3-project/MACS/blob/master/README.md">documentation</a> and the command line help.
For more information about <code class="docutils literal notranslate"><span class="pre">MACS2</span></code>, also see the <a class="reference external" href="https://github.com/macs3-project/MACS">source code</a> and <a class="reference external" href="https://genomebiology.biomedcentral.com/articles/10.1186/gb-2008-9-9-r137">published article</a>.
Depending on the selected extension(s), the option(s) will be set automatically (please see table below).
Please note that there are extensions, that are incompatible with each other, because they require the –broad option either to be enabled or disabled.</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 31%" />
<col style="width: 39%" />
<col style="width: 10%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Extension for the output files</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Option</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>NAME_peaks.xls</p></td>
<td><p>a table with information about called</p>
<p>peaks</p>
</td>
<td><p>excel</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>NAME_control_lambda.bdg</p></td>
<td><p>local biases estimated for each genomic</p>
<p>location from the control sample</p>
</td>
<td><p>bedGraph</p></td>
<td><p>--bdg or -B</p></td>
</tr>
<tr class="row-even"><td><p>NAME_treat_pileup.bdg</p></td>
<td><p>pileup signals from treatment sample</p></td>
<td><p>bedGraph</p></td>
<td><p>--bdg or -B</p></td>
</tr>
<tr class="row-odd"><td><p>NAME_peaks.broadPeak</p></td>
<td><p>similar to _peaks.narrowPeak file,</p>
<p>except for missing the annotating peak</p>
<p>summits</p>
</td>
<td><p>BED 6+3</p></td>
<td><p>--broad</p></td>
</tr>
<tr class="row-even"><td><p>NAME_peaks.gappedPeak</p></td>
<td><p>contains the broad region and narrow</p>
<p>peaks</p>
</td>
<td><p>BED 12+3</p></td>
<td><p>--broad</p></td>
</tr>
<tr class="row-odd"><td><p>NAME_peaks.narrowPeak</p></td>
<td><p>contains the peak locations, peak</p>
<p>summit, p-value and q-value</p>
</td>
<td><p>BED 6+4</p></td>
<td><p>if not set --broad</p></td>
</tr>
<tr class="row-even"><td><p>NAME_summits.bed</p></td>
<td><p>peak summits locations for every peak</p></td>
<td><p>BED</p></td>
<td><p>if not set --broad</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</section>
<section id="authors">
<h2>Authors<a class="headerlink" href="#authors" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>Antonie Vietor</p></li>
</ul>
</section>
<section id="code">
<h2>Code<a class="headerlink" href="#code" title="Permalink to this headline"></a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;Antonie Vietor&quot;</span>
<span class="n">__copyright__</span> <span class="o">=</span> <span class="s2">&quot;Copyright 2020, Antonie Vietor&quot;</span>
<span class="n">__email__</span> <span class="o">=</span> <span class="s2">&quot;antonie.v@gmx.de&quot;</span>
<span class="n">__license__</span> <span class="o">=</span> <span class="s2">&quot;MIT&quot;</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">snakemake.shell</span> <span class="kn">import</span> <span class="n">shell</span>

<span class="n">log</span> <span class="o">=</span> <span class="n">snakemake</span><span class="o">.</span><span class="n">log_fmt_shell</span><span class="p">(</span><span class="n">stdout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">in_contr</span> <span class="o">=</span> <span class="n">snakemake</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;control&quot;</span><span class="p">)</span>
<span class="n">params</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">snakemake</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
<span class="n">opt_input</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="n">out_dir</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

<span class="n">ext</span> <span class="o">=</span> <span class="s2">&quot;_peaks.xls&quot;</span>
<span class="n">out_file</span> <span class="o">=</span> <span class="p">[</span><span class="n">o</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">snakemake</span><span class="o">.</span><span class="n">output</span> <span class="k">if</span> <span class="n">o</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">ext</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">out_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">out_file</span><span class="p">[:</span> <span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">ext</span><span class="p">)])</span>
<span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">out_file</span><span class="p">)</span>

<span class="k">if</span> <span class="n">in_contr</span><span class="p">:</span>
    <span class="n">opt_input</span> <span class="o">=</span> <span class="s2">&quot;-c </span><span class="si">{contr}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">contr</span><span class="o">=</span><span class="n">in_contr</span><span class="p">)</span>

<span class="k">if</span> <span class="n">out_dir</span><span class="p">:</span>
    <span class="n">out_dir</span> <span class="o">=</span> <span class="s2">&quot;--outdir </span><span class="si">{dir}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">dir</span><span class="o">=</span><span class="n">out_dir</span><span class="p">)</span>

<span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s2">&quot;_peaks.narrowPeak&quot;</span><span class="p">,</span> <span class="s2">&quot;_summits.bed&quot;</span><span class="p">))</span> <span class="k">for</span> <span class="n">out</span> <span class="ow">in</span> <span class="n">snakemake</span><span class="o">.</span><span class="n">output</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span>
        <span class="n">out</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s2">&quot;_peaks.broadPeak&quot;</span><span class="p">,</span> <span class="s2">&quot;_peaks.gappedPeak&quot;</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">out</span> <span class="ow">in</span> <span class="n">snakemake</span><span class="o">.</span><span class="n">output</span>
    <span class="p">):</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span>
            <span class="s2">&quot;Output files with _peaks.narrowPeak and/or _summits.bed extensions cannot be created together with _peaks.broadPeak and/or _peaks.gappedPeak extended output files.</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;For usable extensions please see https://snakemake-wrappers.readthedocs.io/en/stable/wrappers/macs2/callpeak.html.</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot; --broad&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span>
                <span class="s2">&quot;If --broad option in params is given, the _peaks.narrowPeak and _summits.bed files will not be created. </span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;Remove --broad option from params if these files are needed.</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="p">)</span>

<span class="k">if</span> <span class="nb">any</span><span class="p">(</span>
    <span class="n">out</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s2">&quot;_peaks.broadPeak&quot;</span><span class="p">,</span> <span class="s2">&quot;_peaks.gappedPeak&quot;</span><span class="p">))</span> <span class="k">for</span> <span class="n">out</span> <span class="ow">in</span> <span class="n">snakemake</span><span class="o">.</span><span class="n">output</span>
<span class="p">):</span>
    <span class="k">if</span> <span class="s2">&quot;--broad &quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">params</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">params</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;--broad&quot;</span><span class="p">):</span>
        <span class="n">params</span> <span class="o">+=</span> <span class="s2">&quot; --broad &quot;</span>

<span class="k">if</span> <span class="nb">any</span><span class="p">(</span>
    <span class="n">out</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s2">&quot;_treat_pileup.bdg&quot;</span><span class="p">,</span> <span class="s2">&quot;_control_lambda.bdg&quot;</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">out</span> <span class="ow">in</span> <span class="n">snakemake</span><span class="o">.</span><span class="n">output</span>
<span class="p">):</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">p</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">params</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;--bdg&quot;</span><span class="p">,</span> <span class="s2">&quot;-B&quot;</span><span class="p">]):</span>
        <span class="n">params</span> <span class="o">+=</span> <span class="s2">&quot; --bdg &quot;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">p</span> <span class="ow">in</span> <span class="n">params</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;--bdg&quot;</span><span class="p">,</span> <span class="s2">&quot;-B&quot;</span><span class="p">]):</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span>
            <span class="s2">&quot;If --bdg or -B option in params is given, the _control_lambda.bdg and _treat_pileup.bdg extended files must be specified in output. </span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="p">)</span>

<span class="n">shell</span><span class="p">(</span>
    <span class="s2">&quot;(macs2 callpeak &quot;</span>
    <span class="s2">&quot;-t </span><span class="si">{snakemake.input.treatment}</span><span class="s2"> &quot;</span>
    <span class="s2">&quot;</span><span class="si">{opt_input}</span><span class="s2"> &quot;</span>
    <span class="s2">&quot;</span><span class="si">{out_dir}</span><span class="s2"> &quot;</span>
    <span class="s2">&quot;-n </span><span class="si">{out_name}</span><span class="s2"> &quot;</span>
    <span class="s2">&quot;</span><span class="si">{params}</span><span class="s2">) </span><span class="si">{log}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../macs2.html" class="btn btn-neutral float-left" title="MACS2" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../maftools.html" class="btn btn-neutral float-right" title="MAFTOOLS" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016, The Snakemake team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>